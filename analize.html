<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>chatApp</title>
    <style>
        body {}

        #output li {

            margin: 0 0 7px 0;
            list-style-type: none;

            padding: 5px 15px 15px 15px;
            background-color: white;


        }

        .empwrapper {
            height: 395px;
            margin: 5px 0 0 15px;

        }

        .topempwrapper {
            background-color: rgba(241, 241, 241, 0.872);
            width: 1300px;
            padding: 10px 0;
        }

        .topempwrapper2 {
            background-color: rgba(241, 241, 241, 0.872);

        }

        .topempwrapper3 {
            background-color: rgba(241, 241, 241, 0.872);

        }

        .empde {
            font-weight: bold;
            height: 180px;

            padding: 5px 15px 15px 15px;
            margin: 5px 0 10px 5px;


        }

        .empinf {
            font-size: 30px;
            font-weight: bold;
            margin: 20px 0 10px 35px
        }

        .evaterm {
            font-weight: bold;
            font-size: 20px;
            margin: auto;
            padding: 20px 0 0 0;
        }

        .evaterm2 {
            width: 400px;
            font-weight: bold;
            margin: 0 0 0 35px;
            padding: 0 0 0 0;
            font-size: 20px;
        }

        .evaterm3 {

            font-weight: bold;
            padding: 100px 0 0 135px;
            margin: 0 0 0 0;
            font-size: 20px;

        }

        .empname {
            font-weight: bold;
            font-size: 20px;
            margin: auto;
            padding: 20px 0 0 0;

        }

        .selfeva {
            height: 250px;
            margin: 5px 15px 0 0;
            width: 200px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;

        }

        .selfeva2 {
            height: 206px;
            margin: 0 15px 0px 0;
            width: 500px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;
        }


        .selfeva3 {
            margin: 0 15px 0px 130px;
            background-color: white;
            width: 150px;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 0px;
        }

        .centered-text {
            text-align: center;
        }



        .valueele {

            font-weight: bold;


            padding: 5px 15px 15px 30px;
            margin: 5px 0 10px 5px;


        }

        .valueelements {
            display: flex;
        }

        #searchInput {
            height: 40px;
            width: 220px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 0 0 0 10px;
        }


        #sdis {
            height: 40px;
            width: 220px;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: flex;
            align-items: center;
            text-align: center;
            font-weight: normal;
            padding: 0 0 0 10px;
            background-color: white;
        }

        #gradis {
            height: 40px;
            width: 220px;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: flex;
            align-items: center;
            text-align: center;
            font-weight: normal;
            padding: 0 0 0 10px;
            background-color: white;
        }

        #output {
            height: 40px;
            width: 220px;
            margin-top: 45px;
            display: flex;
            align-items: center;
            font-weight: normal;
            padding: 0 0 0 0;
        }

        #output2 {
            height: 40px;
            width: 220px;
            margin-top: 45px;
            display: flex;
            align-items: center;
            font-weight: normal;
            padding: 0 0 0 15px;
            margin-top: 5px;
        }

        input {
            height: 250px;
            width: 791.78px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 0 0 0 15px;
        }



        #keywordSelect {
            height: 45px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #valueSelect1 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #valueSelect2 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #valueSelect3 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #valueSelect4 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #valueSelect5 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #valueSelect6 {
            height: 40px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 0 5px 0;
        }

        #searchButton {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #searchButton:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }


        #vsearchButton1 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton1:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }



        #send3 {
            width: 150px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;
            height: 20px;

        }

        #send3:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #vsearchButton2 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton2:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #vsearchButton3 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton3:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #vsearchButton4 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton4:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #vsearchButton5 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton5:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #vsearchButton6 {
            width: 50px;
            border: 1px solid;
            border-radius: 5px;
            margin: 0 0 0 5px;

        }

        #vsearchButton5:hover {
            border: 2px solid #000080;
            color: white;
            font-weight: bold;
            background-color: #000080;
        }

        #output {
            font-size: 16px;
        }

        .feedback {

            border: none;
            background-color: lightblue;
        }

        .selfevacom {
            display: flex;

        }


        #score {
            height: 106px;
            font-weight: bold;
            font-size: 42px;
            text-align: center;
        }

        #kscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }

        #kscore2 {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
        }

        #inputValue {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            height: 40px;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue2 {
            height: 250px;
            font-size: 14px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue3 {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue4 {
            height: 250px;
            font-size: 14px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue5 {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue6 {
            height: 250px;
            font-size: 14px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue7 {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #inputValue8 {
            height: 250px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue9 {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;

        }

        #inputValue10 {
            height: 250px;
            font-size: 14px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #inputValue11 {
            height: 40px;
            font-size: 14px;
            margin: 0 0 7px 0;
            font-size: 20px;
            width: 90px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #inputValue12 {
            height: 250px;
            font-size: 14px;
            margin: 0 10px 0 0;
            font-size: 20px;
            width: 190px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #kscore3 {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
        }

        #iscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }

        #lscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }

        #fscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }

        #hscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }

        #flscore {
            height: 40px;
            font-weight: bold;
            font-size: 24px;
            text-align: center;
            background-color: white;
        }


        .valuekpi {
            font-size: 20px;
            padding: 0 0 0 0;
            margin: 10px 0 0 0;
        }

        .hosscore {
            height: 40px;
            width: 90px;
            margin: 0 0 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .hosscore2 {
            height: 40px;
            width: 90px;
            margin: 0 0 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .hosscore3 {
            height: 40px;
            width: 250px;
            margin: 0 0 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        li {
            list-style: none;
        }

        .btmw {
            padding: 20px 0 10px 30px;
        }

        .space {
            background-color: white;
            width: 1300px;
            height: 20px;
            margin: 25px 0 0 0;
        }

        .forflrex {
            display: flex;
        }

        .selectbtn {
            color: white;
            font-weight: bold;
            background-color: white;
            border: none;
            /* 枠線をなくす */
            border-bottom: 1px solid #ccc;
            /* 下線を追加 */
            background-color: rgba(241, 241, 241, 0.872);
            box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.4);
            margin-top: -1px;
            /* 上部の余白をなくす */
            padding-top: 0;
            /* 上部の余白をなくす */

        }
    </style>
</head>

<body>
    <div class="forflrex">
        <h1 class="empinf">評価者用評価シート</h1>




    </div>


    <div class="topempwrapper">
        <div class="empwrapper">

            <div class="empde">
                <p class="empname">従業員氏名</p>
                <input type="name" id="searchInput" placeholder="キーワードを入力してください">
                <p class="evaterm">評価対象期間</p>
                <select id="keywordSelect">
                    <option value="">期間を選択してください</option>
                    <option value="2023年4月～2023年9月">2023年4月～2023年9月</option>
                    <option value="2023年10月～2024年3月">2023年10月～2024年3月</option>
                    <option value="2024年4月～2024年9月">2024年4月～2024年9月</option>
                    <option value="2024年10月～2025年3月">2024年10月～2025年3月</option>
                    <option value="2025年4月～2025年9月">2025年4月～2025年9月</option>
                    <option value="2025年10月～2026年3月">2025年10月～2026年3月</option>
                    <option value="2026年4月～2026年9月">2026年4月～2026年9月</option>
                    <option value="2026年10月～2027年3月">2026年10月～2027年3月</option>
                    <option value="2027年4月～2027年9月">2027年4月～2027年9月</option>
                    <option value="2027年10月～2028年3月">2027年10月～2028年3月</option>
                </select>

                <button id="searchButton">検索</button>

                <p class="empname">所属部署</p>
                <div id="sdis" class="sdis">
                    <p></p>
                </div>

                <p class="empname">グレード</p>
                <div id="gradis" class="gradis">
                    <p></p>
                </div>

            </div>
        </div>

        <div class="selfevacom">
            <div class="evaterm2">自己評価＿総合

                <div class="selfeva2">
                    <ul id="output"></ul>
                </div>
            </div>



            <div>
                <p class="evaterm3">総合評価点</p>

                <div id="score" class="selfeva3">
                    <p class="centered-text"></p>
                </div>
            </div>

        </div>





        <div class="valueele">


            <p class="evaterm">自己評価＿バリュー項目</p>

            <div class="valueelements">

                <div class="vsele">
                    <div>
                        <p class="valuekpi">KNOWLEDGE</p>
                        <div id="kscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>

                        <div>期初目標参照</div>

                        <select id="valueSelect1">
                            <option value="">期間を選択してください</option>
                            <option value="文章作成力">文章作成力</option>
                            <option value="テクニカルスキル">テクニカルスキル</option>
                            <option value="ラーニングアジリティ">ラーニングアジリティ</option>
                        </select>
                        <button id="vsearchButton1">検索</button>
                    </div>

                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output2"></ul>
                        </div>
                    </div>
                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">INOVATION</p>

                        <div id="iscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>

                        <div>期初目標参照</div>

                        <select id="valueSelect2">
                            <option value="">期間を選択してください</option>
                            <option value="企画発案力">企画発案力</option>
                            <option value="問題定義と改善">問題定義と改善</option>
                            <option value="探求心と追求心">探求心と追求心</option>
                        </select>
                        <button id="vsearchButton2">検索</button>
                    </div>

                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output3"></ul>
                        </div>
                    </div>

                </div>

                <div class="vsele">

                    <div>
                        <p class="valuekpi">LEADERSHIP</p>

                        <div id="lscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>

                        <div>期初目標参照</div>

                        <select id="valueSelect3">
                            <option value="">期間を選択してください</option>
                            <option value="ビジョニング力">ビジョニング力</option>
                            <option value="目標設定と遂行力">目標設定と遂行力</option>
                            <option value="影響力">影響力</option>
                        </select>
                        <button id="vsearchButton3">検索</button>
                    </div>

                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output5"></ul>
                        </div>
                    </div>
                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">FOLLOWERSHIP</p>

                        <div id="fscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>
                        <div>期初目標参照</div>


                        <select id="valueSelect4">
                            <option value="">期間を選択してください</option>
                            <option value="翻訳力">翻訳力</option>
                            <option value="プロジェクトマネジメント">プロジェクトマネジメント</option>
                            <option value="チームマネジメント">チームマネジメント</option>
                        </select>
                        <button id="vsearchButton4">検索</button>

                    </div>
                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output6"></ul>
                        </div>
                    </div>
                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">HOSPITALITY</p>

                        <div id="hscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>
                        <div>期初目標参照</div>


                        <select id="valueSelect5">
                            <option value="">期間を選択してください</option>
                            <option value="企画力">人財育成</option>
                            <option value="問題定義と改善">メンバーシップ</option>
                            <option value="探求心と追求心">セルフマネジメント</option>
                        </select>
                        <button id="vsearchButton5">検索</button>
                    </div>

                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output7"></ul>
                        </div>
                    </div>

                </div>

                <div class="vsele">

                    <div>
                        <p class="valuekpi">FLEXIBILITY</p>
                        <div id="flscore" class="hosscore">
                            <p class="centered-text"></p>
                        </div>

                        <div>期初目標参照</div>

                        <select id="valueSelect6">
                            <option value="">期間を選択してください</option>
                            <option value="現場力">現場力</option>
                            <option value="トラブル対応力">トラブル対応力</option>
                            <option value="クライアント対応力">クライアント対応力</option>
                        </select>

                        <button id="vsearchButton6">検索</button>
                    </div>

                    <div class="selfeva">
                        <div class="postit">
                            <ul id="output8"></ul>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <div class="space"></div>

        <div class="btmw">
            <p class="evaterm">今期評価＿バリュー項目</p>

            <div class="valueelements">

                <div class="vsele">
                    <div>
                        <p class="valuekpi">KNOWLEDGE</p>
                        <select id="inputValue">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue2" class="">
                        </div>


                    </div>


                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">INOVATION</p>
                        <select id="inputValue3">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue4" class="">
                        </div>
                    </div>

                </div>

                <div class="vsele">

                    <div>
                        <p class="valuekpi">LEADERSHIP</p>
                        <select id="inputValue5">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue6" class="">

                        </div>
                    </div>

                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">FOLLOWERSHIP</p>

                        <select id="inputValue7">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue8" class="">

                        </div>

                    </div>

                </div>

                <div class="vsele">
                    <div>
                        <p class="valuekpi">HOSPITALITY</p>
                        <select id="inputValue9">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue10" class="">

                        </div>
                    </div>

                </div>

                <div class="vsele">

                    <div>
                        <p class="valuekpi">FLEXIBILITY</p>
                        <select id="inputValue11">
                            <option value="">評価点</option>
                            <option value="1.0">1.0</option>
                            <option value="1.5">1.5</option>
                            <option value="2.0">2.0</option>
                            <option value="2.5">2.5</option>
                            <option value="3.0">3.0</option>
                            <option value="3.5">3.5</option>
                            <option value="4.0">4.0</option>
                            <option value="4.5">4.5</option>
                            <option value="5.0">5.0</option>
                        </select>
                        <div>
                            <input type="text" id="inputValue12" class="">

                        </div>
                    </div>


                </div>

            </div>




            <p class="evaterm">評価フィードバック</p>

            <div class="valueelements2">

                <div class="vsele">
                    <div>
                        <div class="">
                            <div class="feedbackf">
                                <input id="feedback" type="feedback">
                            </div>
                        </div>
                    </div>
                    <div>
                        <button id="send3">send</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- HTML内のDeleteボタン -->



        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script>
            // 日時をいい感じの形式にする関数
            function convertTimestampToDatetime(timestamp) {
                const _d = timestamp ? new Date(timestamp * 1000) : new Date();
                const Y = _d.getFullYear();
                const m = (_d.getMonth() + 1).toString().padStart(2, '0');
                const d = _d.getDate().toString().padStart(2, '0');
                const H = _d.getHours().toString().padStart(2, '0');
                const i = _d.getMinutes().toString().padStart(2, '0');
                const s = _d.getSeconds().toString().padStart(2, '0');
                return `${Y}/${m}/${d} ${H}:${i}:${s}`;
            }
        </script>



        <!-- 以下にfirebaseのコードを貼り付けよう -->


        <script type="module">

            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";

            import {
                getFirestore,
                collection,
                addDoc,
                serverTimestamp,
                query,
                orderBy,
                onSnapshot,
                where,
            } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";



            const firebaseConfig = {
                apiKey: "AIzaSyA8p9igB4aI27AdtDu7Zvueh4iX4qVRmXo",
                authDomain: "chatapp-miki.firebaseapp.com",
                projectId: "chatapp-miki",
                storageBucket: "chatapp-miki.appspot.com",
                messagingSenderId: "788466822293",
                appId: "1:788466822293:web:34b4a1e607732c8e357f9c"
            };

            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);


            // chatapp.html


            // データ取得処理
            const q = query(collection(db, "chat"), orderBy("time", "desc"));

            onSnapshot(q, (querySnapshot) => {
                const documents = [];
                querySnapshot.docs.forEach(function (doc) {
                    const document = {
                        id: doc.id,
                        data: doc.data(),
                    };
                    documents.push(document);
                });
                console.log(documents);

                //  ここまでは毎回同じ


                // 検索ボタンのクリックイベントハンドラ
                $("#searchButton").on("click", function () {
                    // 入力されたキーワードを取得
                    const keyword = $("#searchInput").val();
                    const selectedTerm = $("#keywordSelect option:selected").val();

                    // Firestore のデータを検索
                    searchDocuments(keyword, selectedTerm);
                    console.log(documents);

                });

                // ドキュメントを検索して表示する関数
                function searchDocuments(keyword, selectedTerm) {
                    const htmlElements = [];
                    documents.forEach(function (document) {
                        const time = document.data.time && document.data.time.seconds ? convertTimestampToDatetime(document.data.time.seconds) : "";
                        const documentTerm = document.data.term;

                        console.log("documentTerm:", documentTerm); // 追加
                        if (document.data.name && document.data.name.includes(keyword) && documentTerm === selectedTerm) {


                            htmlElements.push(`
            <li id="${document.id}">
                <p>${document.data.text}</p>  
              
          
            </li>
            `);
                            const tavgValue = document.data.tavg;
                            $("#score").text(tavgValue);
                            const secValue = document.data.section;
                            $("#sdis").text(secValue);
                            const graValue = document.data.grade;
                            $("#gradis").text(graValue);
                            const kavgValue = document.data.kavg;
                            $("#kscore").text(kavgValue);
                            const iavgValue = document.data.iavg;
                            $("#iscore").text(iavgValue);
                            const lavgValue = document.data.lavg;
                            $("#lscore").text(lavgValue);
                            const favgValue = document.data.favg;
                            $("#fscore").text(favgValue);
                            const havgValue = document.data.havg;
                            $("#hscore").text(havgValue);
                            const flavgValue = document.data.flavg;
                            $("#flscore").text(flavgValue);
                        }
                    });

                    $("#output").html(htmlElements);
                }
            })




            // データ取得処理
            const r = query(collection(db, "chat"), orderBy("time", "desc"));

            onSnapshot(r, (querySnapshot) => {

                const documents = [];
                querySnapshot.docs.forEach(function (doc) {
                    const document = {
                        id: doc.id,
                        data: doc.data(),
                    };
                    documents.push(document);
                });

                console.log(documents);

                //  ここまでは毎回同じ





                // 検索ボタンのクリックイベントハンドラ
                $("#vsearchButton1").on("click", function () {

                    const keyword2 = $("#searchInput").val();
                    const selectedTerm2 = $("#valueSelect1 option:selected").val();

                    // Firestore のデータを検索
                    searchDocuments(keyword2, selectedTerm2);
                    console.log(documents);

                });

                // ドキュメントを検索して表示する関数
                function searchDocuments(keyword2, selectedTerm2) {
                    const htmlElements2 = [];
                    documents.forEach(function (document) {
                        const time = document.data.time && document.data.time.seconds ? convertTimestampToDatetime(document.data.time.seconds) : "";
                        const documentTerm2 = document.data.kno;

                        console.log("documentTerm2:", documentTerm2); // 追加

                        if (documentTerm2 === selectedTerm2) {
                            if (document.data.name2 && document.data.name2.includes(keyword2) && documentTerm2 === selectedTerm2) {
                                htmlElements2.push(`
                    <li id="${document.id}">
                                    <p>${document.data.ktext}</p>  
                                </li>
            `);
                            }
                        }
                    });


                    $("#output2").html(htmlElements2);
                }
            })



            // データ取得処理
            const s = query(collection(db, "chat"), orderBy("time", "desc"));

            onSnapshot(s, (querySnapshot) => {

                const documents = [];
                querySnapshot.docs.forEach(function (doc) {
                    const document = {
                        id: doc.id,
                        data: doc.data(),
                    };
                    documents.push(document);
                });

                console.log(documents);

                // 検索ボタンのクリックイベントハンドラ
                $("#vsearchButton2").on("click", function () {

                    const keyword3 = $("#searchInput").val();
                    const selectedTerm3 = $("#valueSelect2 option:selected").val();

                    // Firestore のデータを検索
                    searchDocuments(keyword3, selectedTerm3);
                    console.log(documents);

                });

                // ドキュメントを検索して表示する関数
                function searchDocuments(keyword3, selectedTerm3) {
                    const htmlElements3 = [];
                    documents.forEach(function (document) {
                        const time = document.data.time && document.data.time.seconds ? convertTimestampToDatetime(document.data.time.seconds) : "";
                        const documentTerm3 = document.data.ino;

                        console.log("documentTerm3:", documentTerm3); // 追加
                        if (documentTerm3 === selectedTerm3) {

                            htmlElements.push(`      
                    <li id="${document.id}">
                        <p>${document.data.itext}</p>
                

                            </li>
             `);
                        }
                    }


                    )
                    $("#output2").html(htmlElements2);
                }
            })



            // chatapp.html

            $("#send3").on("click", function () {

                // chatapp.html
                const postData = {
                    name: $("#searchInput").val(),
                    term: $("#keywordSelect").val(),
                    knowledge: $("#inputValue").val(),
                    inovation: $("#inputValue3").val(),
                    learship: $("#inputValue5").val(),
                    followership: $("#inputValue7").val(),
                    hospitality: $("#inputValue9").val(),
                    flexibility: $("#inputValue11").val(),
                    knowledge_com: $("#inputValue2").val(),
                    inovation_com: $("#inputValue4").val(),
                    learship_com: $("#inputValue6").val(),
                    followership_com: $("#inputValue8").val(),
                    hospitality_com: $("#inputValue10").val(),
                    feedback: $("#feedback").val(),

                };
                addDoc(collection(db, "chat"), postData);
                alert("送信されました"); // メッセージを表示する

            });
        </script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script
            src='https://www.bing.com/api/maps/mapcontrol?key=Atw9JtpaVdOnOZAqg1A5Zg6CQBjstnSNxU3NcDljdfDFEAz5JX3neJ0kvD5GCzbO'
            async defer></script>
        <script>

            let map;

            function mapsInit(position) {
                const lat = position.coords.latitude;
                const lng = position.coords.longitude;
                map = new Microsoft.Maps.Map("#map", {
                    center: {
                        latitude: lat,
                        longitude: lng,
                    },
                    zoom: 15,
                });
            }

            function showError(error) {
                const errorMessages = [
                    "位置情報が許可されていません",
                    "現在位置を特定できません",
                    "位置情報を取得する前にタイムアウトになりました",
                ];
                alert(`error:${errorMessages[error.code - 1]}`);

            }

            const option = {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 10000,
            }

            window.onload = function () {
                navigator.geolocation.getCurrentPosition(mapsInit, showError, option);
            };


        </script>












</body>

</html>